function append(e,t,n){var r={time:400};for(var i in n)r[i]=n[i];e.append(t)}function parse(e,t){if(e.ret==2){var n=e.data.wx_appid,r=location.host;location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+n+"&redirect_uri=http://"+r+"/wechat&response_type=code&scope=snsapi_userinfo&connect_redirect=1#wechat_redirect"}return e.ret==0&&e.code==1,e.ret==0&&e.code==1&&this.url!="user/status"?!1:e.ret==0&&this.url!="user/status"?error("操作失败",e.info):e.data}function wx_sign(){$.post("/sign",{url:location.href},function(e){wx.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","chooseImage","uploadImage","downloadImage"]})})}function wx_choose_image(e,t){wx.chooseImage({count:1,success:function(n){var r=n.localIds,i=r.toString();wx.uploadImage({localId:i,isShowProgressTips:1,success:function(n){var r=n.serverId,i={desc:e+"-"+t,media_id:r};$.post("/wxactgod/upload",i,function(t){t.result=="ok"&&(location.href="http://"+location.hostname+"/boys/uploadsuccess/uploadsuccess#"+e)})}})}})}function share_friend(e,t,n){var r={};r.title="你和男神只有一个头像的距离",r.desc="图派PS爱好者免费为你定制男神同款特效头像，",r.img="http://"+location.hostname+"/img/favicon.ico",r.link="http://"+location.hostname+"/boys/index/index",r.id="",r.code="";for(var i in e)e[i]&&(r[i]=e[i]);wx.ready(function(){wx.onMenuShareAppMessage({title:r.title,desc:r.desc,link:r.link,imgUrl:r.img,type:"link",dataUrl:"",success:function(){t&&t(),r.id!=""&&r.code==-2?location.href="http://"+location.hostname+"/boys/shareavatar/shareavatar#"+r.id:r.code==-2&&(location.href="http://"+location.hostname+"/boys/index/index#"+r.id)},cancel:function(){n&&n()}})})}function share_friend_circle(e,t,n){var r={};r.title="#私人定制#扑倒男神同款头像",r.img="http://"+location.hostname+"/img/favicon.ico",r.link="http://"+location.hostname+"/boys/index/index",r.id="";for(var i in e)e[i]&&(r[i]=e[i]);r.img="http://"+location.hostname+"/img/favicon.ico",wx.ready(function(){wx.onMenuShareTimeline({title:r.title,link:r.link,imgUrl:r.img,success:function(){r.id!=""&&r.code==-2?location.href="http://"+location.hostname+"/boys/shareavatar/shareavatar#"+r.id:r.code==-2&&(location.href="http://"+location.hostname+"/boys/index/index#"+r.id),t&&t()},cancel:function(){n&&n()}})})}(function(e){var t=e.ajax,n=[];e.time33=function(e){var t=0;for(var n=e.length-1;n>=0;n--)t=t*33+e.substr(n,n+1).charCodeAt();return t.toString(36)};var r=function(){var e=document.createElement("div");return e.id="__loading",e.className="body_loading",e.innerHTML="<img src='/img/loading.gif' alt='加载中...' />",e.style.position="absolute",e.style.left="49%",e.style.top="64%",e.style.zIndex="9999999",e}();e.ajax=function(i){var s=e.time33(i.url);n[s]!=null&&n[s].abort();var o={beforeSend:function(e){},success:function(e,t){},error:function(e,t,n){}};i.beforeSend&&(o.beforeSend=i.beforeSend),i.error&&(o.error=i.error),i.success&&(o.success=i.success);var u=e.extend(i,{beforeSend:function(t){(typeof i.loading=="undefined"||i.loading==1)&&e("body").append(r),i.type.toLowerCase()!="post"&&(i.url=encodeURI(i.url)),o.beforeSend(t)},error:function(t,n,r){o.error(t,n,r),e("#__loading").remove()},success:function(t,n){t=parse(t),o.success(t,n),e("#__loading").remove()}});n[s]=t(u)}})($);