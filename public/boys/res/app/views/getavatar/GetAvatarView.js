define(["app/views/base","tpl!app/views/getavatar/GetAvatarView.html"],function(e,t){"use strict";return e.extend({tagName:"div",className:"",template:t,events:{"click #uploadPopup":"popHowto","click .pop-howto":"popHowto","click #uploadImage":"uploadImage","click .share":"clickShare","click .share-mask":"clickShare","click #downloadImage":"downloadImage"},downloadImage:function(){wx_download_image()},clickShare:function(e){$(".share-mask").removeClass("none"),$(e.target).hasClass("share-mask")&&$(".share-mask").addClass("none")},initialize:function(){this.listenTo(this.model,"change",this.render),this.model.fetch()},uploadImage:function(){var e=$(".get-avatar").attr("index"),t=$("#uploadPopup").attr("data-rand"),n=t,r=e;wx_choose_image(r,n)},popHowto:function(e){$(".pop-howto").removeClass("none"),$(e.target).hasClass("pop-howto")&&$(".pop-howto").addClass("none")},onShow:function(){var e=$("#uploadPopup").attr("data-rand"),t=window.location.hash.substr(1),n=$(".after").find(".avatar-effect").eq(t),r=$(".tips").find(".random").eq(t);$(".get-avatar").attr("index",t),$(".before").find("img").eq(t).removeClass("none").siblings("img").addClass("none"),n.removeClass("none").siblings("img").addClass("none"),n.find("img").eq(e).removeClass("none").siblings("img").addClass("none"),r.removeClass("none").siblings(".random").addClass("none"),r.find("img").eq(e).removeClass("none").siblings("img").addClass("none");var i={};i.id=t,i.code=-2,share_friend(i,function(){},function(){}),share_friend_circle(i,function(){},function(){})}})});