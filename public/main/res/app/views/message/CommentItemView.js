define(["app/views/Base","tpl!app/templates/message/CommentItemView.html","emojione"],function(e,t,n){"use strict";return e.extend({tagName:"div",className:"",template:t,events:{"click .reply-comment":"replyComment","click .comment-btn":"CommentBtn"},CommentBtn:function(e){var t=$(e.currentTarget).siblings("#commentContent"),n=t.val(),r=t.attr("data-sender"),i=t.attr("type"),s=t.attr("comment-id"),o=t.attr("target-id"),u="/comments/save",a={content:n,type:i,id:o,reply_to:r,for_comment:s};$.post(u,a,function(t){var n=t.info;t.ret==1&&($(e.currentTarget).parents(".comment-frame").addClass("hide"),$(e.currentTarget).parents(".call-back-container").find(".reply-comment").text("回复"),toast("回复评论成功"),console.log(t.ret))})},replyComment:function(e){$(e.currentTarget).parents(".call-back").siblings(".comment-frame").toggleClass("hide");var t=$(e.currentTarget).parents(".call-back").siblings(".comment-frame").hasClass("hide");t?$(e.currentTarget).text("回复"):$(e.currentTarget).text("收起")},construct:function(){var e=this;$("a.menu-bar-item").removeClass("active"),this.listenTo(this.collection,"change",this.render),e.scroll(),e.collection.loading(e.showEmptyView)},showEmptyView:function(e){e.data.page==1&&e.length==0&&append($("#contentView div"),".emptyContentView")}})});