define(["common","app/views/Base","tpl!app/templates/BaseMaterialView.html"],function(e,t,n){"use strict";return t.extend({tagName:"div",className:"",template:n,events:{"click .submit":"submit","click #select-girl":"selectGirl","click #select-boy":"selectBoy","keyup .nickname-input":"keyupNickename","click .setting-sex input":"ChangeSex"},onRender:function(){Common.upload("#upload_avatar",function(e){$(".head-picture img").attr("src",e.data.url),$(".submit-btn").addClass("bg-submit submit")},null,{url:"/upload"})},ChangeSex:function(){$(".submit-btn").addClass("bg-color submit")},keyupNickename:function(){var e=$(".nickname-input input").val();if(e=="")return alert("昵称不能为空哦"),$(".submit-btn").removeClass("bg-color submit"),!1;$(".submit-btn").addClass("bg-color submit")},construct:function(){this.listenTo(this.model,"change",this.render)},selectBoy:function(e){var t=e;$(t.currentTarget).addClass("boy-pressed").parent().parent().find("#select-girl").removeClass("girl-pressed")},selectGirl:function(e){var t=e;$(t.currentTarget).addClass("girl-pressed").parent().parent().find("#select-boy").removeClass("boy-pressed")},submit:function(){var e=$(".head-picture img").attr("src"),t=$(".nickname-input input").val(),n=$(".setting-sex input[type='radio']:checked").attr("id")=="select-boy"?1:0;if(t=="")return error("操作失败","昵称不能为空哦"),!1;$.post("/user/save",{avatar:e,nickname:t,sex:n},function(e){var t=$(".head-picture img").attr("src");$(".user-avatar img").attr("src",t),toast("修改成功")})}})});